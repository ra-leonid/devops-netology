## Команды работы с потоками

`read new_var` - чтение с клавиатуры в переменную

`echo $new_var` - вывод переменной на экран

* **stdin** или **standard input** – стандартный ввод, условный номер **0**
  * ввод команды и ее аргументов в shell: `ls -l`, `man ls`
* **stdout** или **standard output** – стандартный вывод, условный номер **1**
  * вывод результата работы команды: листинг директорий `ls`, документация man
* **stderr** или **standard error** – стандартный вывод ошибок, условный номер **2**
  * вывод ошибок при работе команды: сообщение о вызове `ls` на несуществующую директорию, `man` на отсутствующую команду

Кроме файловых систем, предназначенных для работы с физическими накопителями, в Linux существуют и виртуальные псевдо-файловые системы, две из которых мы сегодня затронем:
* **/dev** (файловое представление устройств)
* **/proc** (файловое представление структур ядра)


`lsof` - вывод процессов, их файловых дескрипторов и задействованных в них файлов

**Примеры**:
* `lsof -i 4 -a -p 1234` (просмотр всех соединений IPv4, открытых процессом с PID = 1234)
* `lsof -i tcp:80` (просмотр информации о процессе, который прослушивает 80 TCP порт)
* `lsof /dev/hd4` (Список открытых файлов на устройстве /dev/hd4)
* `lsof /dev/cdrom` (Список процессов, работающих с CD ROM)
* `lsof -c ssh` (Список подключений по ssh)
* `lsof -p $$` - список открытых файлов нашим shell
 

`ls -l /proc/$$/fd/{0,1,2}` - отображение дескрипторов ввода/вывода нашего shell

`pstree -p` - вывод всех процессов в виде дерева

`echo $$` - PID текущего процесса shell (bash)

`echo $PPID` - PID **родителя** текущего процесса shell (bash)

`jobs -l` - вывод информации о задачах

`top` - список активных процессов

`tty` - имя используемого терминала

## Команды работы с системными устройствами

`uptime` - время работы операционной системы

`evtest` - вывод информации о системных устройствах

**Пример**:
`evtest /dev/input/event2` - информация о клавиатуре

## Остальные

`whereis` - информация о месторасположении файлов команды

`wc` - подсчитать количество строк или слов в тексте

`history` - история команд

`!2` - выполнить команду по номеру из истории

## Работа с сессиями

`screen` - создание screen-сессии. Особенность такой сессии заключается в том, что при разрыве соединения по ssh, она не прервёт своё выполнение

`screen -S имя_сессия_скрин` - создание именованной сессии


* Ctrl+a и c - создать дополнительное окно ;
* Ctrl+a и A - переименовать текущее окно;
* Ctrl+a и 0 - переключиться на окно с номером 0 (номер может быть иной);
* Ctrl+a и S - разделить окно по горизонтали на две области;
* Ctrl+a и | - разделить окно по вертикали на две области;
* Ctrl+a и tab - переключить рабочий фокус на следующую область разделенного окна;
* Ctrl+a и Ctrl+a - переключить рабочий фокус на предыдущую область разделенного окна;
* Ctrl+a и Q - закрыть все разделенные области кроме;
* Ctrl+a и " - показать список всех имеющихся окон;
* Ctrl+a и X - закрыть текущую область;

`Ctrl+a и d` - Выход из сессии. Запущенная вами в этот момент команда не остановится и будет продолжать свое выполнение.

`screen -r` - возврат к сессии

Если у вас запущено больше чем одна screen - сессия, то после ключа `-r` нужно указать ее ID. Узнать его просто с помощью команды:

`screen -ls`

Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Для этого используем `reptyr`. Так можно перенести в screen процесс, который вы запустили по ошибке в обычной SSH-сессии:

* `echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope` - временно разрешаем подключение к удаленной программе (без этой команды будет ошибка: "*The kernel denied permission while attaching. If your uid matches the target's, check the value of /proc/sys/kernel/yama/ptrace_scope*").
* Создаем продолжительный процесс `top`
* Останавливаем его `Ctrl+z`
* Отключаем задание от родителя `disown top`. В результате выполнения команды выведется PID отключенного процесса. Запоминаем его.
```commandline
vagrant@vagrant:~$ disown top
-bash: warning: deleting stopped job 1 with process group 1287
```
* Запускаем мультиплексор терминала `screen -S top`
* Подключаемся к фоновому процессу `reptyr 1287`
* Выходим `Ctrl-a d`
* Всё, можем отключаться от сессии ssh, при повторном входе и подключению к терминалу screen, мы увидим свой процесс 


## Vagrant

`vagrant ssh` - подключиться по SSH под юзером vagrant

`vagrant suspend` - поставить на паузу

`vagrant halt` - выключить

`vagrant reload` - перезагрузить конфиг (без выполнения provision)

`vagrant reload --provision`

`vagrant destroy` - удалить виртуалку

`vagrant box list` - cписок доступных "боксов"